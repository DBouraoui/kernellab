import{b as c,j as e,d as U,t as a,e as x}from"./app-C5lTwHdN.js";import{I as $}from"./input-AiS0ET7Q.js";import{B as f}from"./button-B3Yl_OTn.js";import{T as L,a as g,b as j,c as b}from"./tooltip-DQ74tlMz.js";import{I as O}from"./image-Ccmlbdqc.js";import{C as S}from"./check-PtdWg4I3.js";import{C as v}from"./copy-C4t4hEDh.js";import{X as z}from"./x-BXwvSmSF.js";import{C as E}from"./cloud-upload-Belo_Jf8.js";import"./app-B1pgpXbD.js";import"./index-DYvc6laF.js";import"./index-XrecUg5K.js";import"./index-Bi8myhfb.js";import"./index-BTa5M561.js";import"./index-CBZxXS5R.js";import"./index-v9zI-M-E.js";import"./index-6raR_gNw.js";import"./index-MV30uHUT.js";import"./index-DNHXitqj.js";import"./index-DRjZeCPR.js";import"./index-D0If7yHc.js";function se({value:s,onChange:d,maxFiles:i=4,className:y=""}){const[p,m]=c.useState(!1),[w,n]=c.useState(!1),[N,u]=c.useState(null),h=async t=>{const r=t.target.files;if(!r||r.length===0)return;if(s.length+r.length>i){a.error(`Maximum ${i} images autorisées`);return}m(!0);const l=new FormData;Array.from(r).forEach(o=>{l.append("images[]",o)});try{const o=await x.post("/dashboard/upload-images",l,{headers:{"Content-Type":"multipart/form-data"}});d([...s,...o.data.urls]),a.success(`${o.data.urls.length} image(s) téléchargée(s)`)}catch{a.error("Échec du téléchargement")}finally{m(!1)}},C=(t,r)=>{const l=`![description](${t})`;navigator.clipboard.writeText(l),u(r),a.success("Lien Markdown copié !"),setTimeout(()=>u(null),2e3)},k=async t=>{try{await x.post("/dashboard/delete-image",{url:t}),d(s.filter(r=>r!==t)),a.success("Image supprimée")}catch{a.error("Échec de la suppression")}},D=t=>{t.preventDefault(),n(!0)},T=()=>{n(!1)},I=t=>{t.preventDefault(),n(!1);const r=t.dataTransfer.files;r.length>0&&h({target:{files:r}})};return e.jsx(L,{children:e.jsxs("div",{className:`space-y-4 w-full ${y}`,children:[e.jsx("div",{className:"flex items-center justify-between text-xs font-bold uppercase tracking-widest text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-3 w-3"}),e.jsxs("span",{children:["Galerie (",s.length,"/",i,")"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full",children:[s.map((t,r)=>e.jsxs("div",{className:"relative group aspect-video border rounded-xl overflow-hidden bg-muted shadow-sm transition-all hover:ring-2 hover:ring-primary/20",children:[e.jsx("img",{src:t,alt:`Uploaded ${r}`,className:"object-cover w-full h-full transition-transform group-hover:scale-105"}),e.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsxs(g,{children:[e.jsx(j,{asChild:!0,children:e.jsx(f,{type:"button",onClick:()=>C(t,r),variant:"secondary",size:"sm",className:"h-8 w-8 p-0 rounded-full",children:N===r?e.jsx(S,{className:"h-4 w-4 text-green-600"}):e.jsx(v,{className:"h-4 w-4"})})}),e.jsx(b,{children:"Copier le lien Markdown"})]}),e.jsxs(g,{children:[e.jsx(j,{asChild:!0,children:e.jsx(f,{type:"button",onClick:()=>k(t),variant:"destructive",size:"sm",className:"h-8 w-8 p-0 rounded-full",children:e.jsx(z,{className:"h-4 w-4"})})}),e.jsx(b,{children:"Supprimer l'image"})]})]}),e.jsxs("div",{className:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-black/60 rounded text-[8px] text-white backdrop-blur-sm",children:[t.split("/").pop()?.substring(0,10),"..."]})]},r)),s.length<i&&e.jsxs("label",{className:`flex flex-col items-center justify-center border-2 border-dashed rounded-xl cursor-pointer transition-all aspect-video
                            ${w?"border-primary bg-primary/5":"border-muted-foreground/20 hover:border-primary/50 hover:bg-muted/50"}`,onDragOver:D,onDragLeave:T,onDrop:I,children:[p?e.jsx(U,{className:"h-6 w-6 animate-spin text-primary"}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx(E,{className:"w-6 h-6 mb-1 mx-auto text-muted-foreground"}),e.jsx("p",{className:"text-[10px] font-medium text-muted-foreground",children:"Upload"})]}),e.jsx($,{type:"file",multiple:!0,className:"hidden",onChange:h,disabled:p,accept:"image/*"})]})]}),s.length>0&&e.jsxs("p",{className:"text-[10px] text-muted-foreground italic text-center",children:["Astuce : Cliquez sur ",e.jsx(v,{className:"inline h-3 w-3"})," pour insérer l'image dans votre texte."]})]})})}export{se as default};
